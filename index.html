<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Periodic Timer: Periodic Timer, Lightweight Timer Utility Using Asio</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Periodic Timer
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Periodic Timer, Lightweight Timer Utility Using Asio </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="autotoc_md0"></a>
Overview</h2>
<p>The <code>periodic_timer</code> class template is an asynchronous periodic timer that wraps and simplifies Asio timers when periodic callbacks are needed. The periodicity can be based on either a simple duration or on timepoints based on a duration. When the timer is started, the application specifies whether each callback is invoked based on a duration (e.g. one second after the last callback), or on timepoints (e.g. a callback will be invoked each second according to the clock).</p>
<p>The Asio library does not directly provide periodic timers. Instead, application code using Asio must chain together function object callbacks until satisfied.</p>
<p>The <code>periodic_timer</code> class template is a thin wrapper supplying the chaining, with two options for the periodicity. In addition, elapsed times are computed and provided to the application supplied callback.</p>
<p>One periodicity option is to invoke the application callback after a duration. It is simple and provides consistency, specially if the system clock is allowed to be adjusted.</p>
<p>The second periodicity option is to invoke the application callback based on timepoints. This works well in environments where activities must be processed on regular time intervals, regardless of how much processing is performed in each application callback. For example, an application may desire a timer callback to be invoked once every 500 milliseconds and the callback takes 15 milliseconds to excecute. Also occasionally the operating environment takes an extra 10 or 20 milliseconds before invoking the callback. Using a duration instead of a timepoint the actual interval is now 515 milliseconds between callback invocations, with occasional intervals up to 535 milliseconds. A timepoint timer will instead invoke the callback every 500 milliseconds (depending on operating system precision and load) regardless of how much time is taken by the previous callback.</p>
<p>The main disadvantange of timepoint based callbacks is that they can be affected by system clock adjustments. In addition, if the timepoint interval is small and a large amount of processing is performed by the callback, "overflow" can occur, where the next timepoint callback is overrun by the current processing.</p>
<p>An excellent article on this topic by Tony DaSilva can be [read here] (<a href="https://bulldozer00.blog/2013/12/27/periodic-processing-with-standard-c11-facilities/">https://bulldozer00.blog/2013/12/27/periodic-processing-with-standard-c11-facilities/</a>).</p>
<p>An asynchronous timer is more resource-friendly regarding system resources than creating a thread that sleeps. In particular, creating hundreds or thousands of timers is very expensive in a "thread per timer" design.</p>
<h3><a class="anchor" id="autotoc_md1"></a>
Additional Details</h3>
<p><code>periodic_timer</code> is a class template corresponding to a single timer object. Designs needing many periodic timer objects, possibly sorted by time (e.g. a priority queue based on a time stamp) will need to create their own containers and data structures, using <code>periodic_timer</code> as a container element.</p>
<p>Asynchronous processing is performed by the Asio <code>io_context</code> (C++ executor context) passed in to the constructor by the application.</p>
<p>A <code>periodic_timer</code> stops when the application supplied function object returns <code>false</code> rather than <code>true</code>.</p>
<p>A periodic timer can be used as a "one-shot" timer by finishing after one invocation (i.e. unconditionally return <code>false</code> from the function object).</p>
<dl class="section note"><dt>Note</dt><dd>This class does not perform "this" reference counting. It is up to the application code to guarantee that a <code>periodic_timer</code> has not been destructed before handlers (function object callbacks) are invoked.</dd></dl>
<p>A common idiom is to use <code>std::enable_shared_from_this</code>, call <code>std::shared_from_this</code>, and store the result in the function object callback object.</p>
<dl class="section note"><dt>Note</dt><dd><code>std::chrono</code> facilities seem to be underspecified on <code>noexcept</code>, very few of the functions in <code>periodic_timer</code> are <code>noexcept</code>.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Cliff Green</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>(c) 2017-2025 by Cliff Green</dd></dl>
<p>Distributed under the Boost Software License, Version 1.0. (See accompanying file LICENSE.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt">http://www.boost.org/LICENSE_1_0.txt</a>) </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
